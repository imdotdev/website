"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9186],{66703:function(n,e,t){var r=t(85893),o=t(20949),i=t(11604),s=t(68527),a=t(47398),c=t(15193),u=t(67294),l=t(56721),d=t(58937),h=t(1429),f=t(84696),x=t(21948),m=t(2839),p=t(56184),v=t(17586),j=t(93122);e.Z=function(n){var e=n.post,t=(0,u.useState)(null),g=t[0],y=t[1];return(0,o.ff)("white","#1A202C"),(0,o.ff)("#F7FAFC","#1A202C"),(0,u.useEffect)((function(){e&&f.rR.get("/interaction/followed/".concat(e.creator.id)).then((function(n){return y(n.data)}))}),[]),(0,r.jsx)(i.m$.header,{transition:"box-shadow 0.2s",top:"0",zIndex:"3",left:"0",right:"0",width:"full",bg:(0,o.ff)("transparent","transparent"),children:(0,r.jsxs)(i.m$.div,{height:"4.5rem",mx:"auto",maxW:"1280px",children:[(0,r.jsxs)(s.kC,{w:"100%",h:"100%",align:"center",justify:"space-between",px:{base:"4",md:"6"},children:[(0,r.jsx)(m.ZP,{width:"130"}),(0,r.jsxs)(s.Ug,{spacing:[1,1,2,2],children:[(0,r.jsx)(a.u,{label:"back to home",openDelay:300,children:(0,r.jsx)("a",{href:"".concat(p.N.Search),children:(0,r.jsx)(c.hU,{size:"md",fontSize:"lg",variant:"ghost",color:"current",_focus:{border:null},icon:(0,x.a)("search"),"aria-label":"search in this blog"})})}),(0,r.jsx)(l.Z,{}),(0,r.jsx)(d.Z,{})]})]}),(0,r.jsxs)(s.kC,{w:"100%",align:"center",justify:"space-between",px:{base:"6",md:"10"},mt:"2",children:[(0,r.jsx)("a",{href:"/".concat(e.creator.username),children:(0,r.jsxs)(s.X6,{size:"md",cursor:"pointer",mr:"1",zIndex:"1",children:[e.creator.nickname,"\u7684\u535a\u5ba2"]})}),null!==g&&(0,r.jsx)(h.Z,{targetID:null===e||void 0===e?void 0:e.creator.id,followed:g})]}),(0,r.jsx)(s.iz,{mt:"2"}),(0,r.jsx)(v.Z,{}),(0,r.jsx)(j.Z,{})]})})}},70615:function(n,e,t){var r=t(34051),o=t.n(r),i=t(85893),s=t(67294),a=t(68527),c=t(11391),u=t(15193),l=t(62665),d=t(84696),h=t(38951),f=t(75543),x=t(32532),m=t(96486),p=t(11163);function v(n,e,t,r,o,i,s){try{var a=n[i](s),c=a.value}catch(u){return void t(u)}a.done?e(c):Promise.resolve(c).then(r,o)}function j(n){return function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function s(n){v(i,r,o,s,a,"next",n)}function a(n){v(i,r,o,s,a,"throw",n)}s(void 0)}))}}e.Z=function(n){var e=n.storyID,t=n.storyCreator,r=(0,p.useRouter)(),v=(0,s.useState)(null),g=v[0],y=v[1],b=(0,s.useState)(!1),k=b[0],w=b[1],C=(0,s.useState)(x.a.Favorites),S=C[0],Z=C[1],z=(0,l.Z)().session,I=(0,s.useState)(null),P=I[0],N=I[1];(0,s.useEffect)((function(){D()}),[]);var _=function(){var n=j(o().mark((function n(t){var r;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.rR.post("/story/comment",{targetID:e,md:t});case 2:r=n.sent,w(!1),r.data.replies=[],g.unshift(r.data),R();case 7:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),D=function(){var n=j(o().mark((function n(t){var i,s;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,d.rR.get("/story/comments?id=".concat(e,"&sorter=").concat(null!==t&&void 0!==t?t:S));case 2:i=n.sent,y(i.data),r&&r.asPath.indexOf("#")>-1&&("comments"!=(s=(0,m.split)(r.asPath,"#")[1])&&N(s),setTimeout((function(){location.href="#"+(0,m.split)(r.asPath,"#")[1]}),300));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),R=function(){y([]),y(g)},E=function(n){(0,m.remove)(g,(function(e){return e.id==n})),R()};return(0,i.jsx)(i.Fragment,{children:g&&(0,i.jsxs)(a.gC,{spacing:"2",alignItems:"left",id:"comments",children:[(0,i.jsx)(a.xu,{p:"2",children:(0,i.jsxs)(a.kC,{justifyContent:"space-between",px:"1",children:[(0,i.jsxs)(a.Ug,{spacing:"4",children:[(0,i.jsxs)(a.xv,{children:[" ",g.length," \u6761\u8bc4\u8bba "]}),(0,i.jsxs)(c.Ph,{fontWeight:"500",cursor:"pointer",width:"120px",value:S,onChange:function(n){Z(n.currentTarget.value),D(n.currentTarget.value)},variant:"unstyled",children:[(0,i.jsx)("option",{value:x.a.Favorites,children:" \u83b7\u8d5e\u6700\u591a"}),(0,i.jsx)("option",{value:x.a.Recent,children:"\u6700\u65b0"})]})]}),(0,i.jsx)(u.zx,{size:"sm",onClick:function(n){z?w(!0):d.HN.open()},_focus:{border:null},children:"\u53d1\u8868\u8bc4\u8bba"})]})}),k&&z&&(0,i.jsx)(f.Z,{storyID:e,user:z.user,md:"",onSubmit:_,onCancel:function(){return w(!1)}}),g.map((function(n){return(0,i.jsx)(h.ZP,{user:null===z||void 0===z?void 0:z.user,comment:n,onChange:R,onRemove:E,storyCreator:t,highlight:P},n.id)}))]})})}},85482:function(n,e,t){t.d(e,{Z:function(){return k}});var r=t(34051),o=t.n(r),i=t(85893),s=t(67294),a=t(68527),c=t(47398),u=t(15193),l=t(62665),d=t(85832),h=t(3682),f=t(84696);function x(n,e,t,r,o,i,s){try{var a=n[i](s),c=a.value}catch(u){return void t(u)}a.done?e(c):Promise.resolve(c).then(r,o)}var m=function(n){var e=n.storyID,t=n.width,r=void 0===t?"1.4rem":t,a=(0,s.useState)(n.bookmarked),c=a[0],u=a[1],l=function(){var n,t=(n=o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.rR.post("/story/bookmark/".concat(e));case 2:u(!c);case 3:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function s(n){x(i,r,o,s,a,"next",n)}function a(n){x(i,r,o,s,a,"throw",n)}s(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,i.jsx)(h.Z,{"aria-label":"bookmark",variant:"ghost",layerStyle:"textSecondary",_focus:{border:null},icon:c?"bookmarked":"bookmark",onClick:l,width:r})},p=t(11163),v=t(56184),j=t(26822),g=t(70577),y=t(8193);function b(n,e,t,r,o,i,s){try{var a=n[i](s),c=a.value}catch(u){return void t(u)}a.done?e(c):Promise.resolve(c).then(r,o)}var k=function(n){var e=n.story,t=n.pos,r=void 0===t?"fixed":t,s=n.showBg,x=void 0===s||s,k=n.size,w=void 0===k?"md":k,C=n.onStoryChange,S=(0,l.Z)().session,Z=(0,p.useRouter)(),z=function(){var n,t=(n=o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.rR.post("/pin/global/".concat(e.id));case 2:e.pinned=!e.pinned,C(e);case 4:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function s(n){b(i,r,o,s,a,"next",n)}function a(n){b(i,r,o,s,a,"throw",n)}s(void 0)}))});return function(){return t.apply(this,arguments)}}();return(0,i.jsxs)(a.gC,{alignItems:"left",pos:r,display:{base:"none",md:"flex"},p:"2",className:x?"side-card":null,spacing:"md"==w?6:2,children:[(0,i.jsx)(a.xu,{children:(0,i.jsx)(d.Z,{count:e.likes,storyID:e.id,liked:e.liked,fontSize:"md"==w?"1.5rem":"1.2rem",heartSize:"1.4rem"})}),(0,i.jsx)(a.xu,{children:(0,i.jsx)(m,{width:"md"==w?"1.4rem":"1.1rem",storyID:e.id,bookmarked:e.bookmarked})}),(0,i.jsx)(a.xu,{children:(0,i.jsx)(h.Z,{"aria-label":"go to github",variant:"ghost",layerStyle:"textSecondary",_focus:{border:null},fontWeight:"300",icon:"share",width:"md"==w?"1.5rem":"1.2rem",onClick:function(){return location.href="#comments"}})}),e.creatorId===(null===S||void 0===S?void 0:S.user.id)&&(0,i.jsx)(a.xu,{children:(0,i.jsx)(h.Z,{"aria-label":"go to github",variant:"ghost",layerStyle:"textSecondary",_focus:{border:null},fontWeight:"300",width:"md"==w?"1.5rem":"1.2rem",onClick:function(){return Z.push(e.url?"".concat(v.N.Editor,"/posts"):e.type===j.iJ.Post?"".concat(v.N.Editor,"/post/").concat(e.id):e.type===j.iJ.Series?"".concat(v.N.Editor,"/series?id=").concat(e.id):e.type==j.iJ.Discussion?"".concat(v.N.Editor,"/discussion/").concat(e.id):"")},icon:"edit"})}),(0,g.SL)(null===S||void 0===S?void 0:S.user.role)&&(0,i.jsx)(a.xu,{children:(0,i.jsx)(c.u,{label:e.pinned?"\u6587\u7ae0\u4ee5\u88ab\u6536\u5165\u7f16\u8f91\u7cbe\u9009":"\u5c06\u6587\u7ae0\u6536\u5165\u7f16\u8f91\u7cbe\u9009\u4e2d",children:(0,i.jsx)(u.hU,{"aria-label":"a icon button",variant:"ghost",_focus:{border:null},icon:e.pinned?(0,i.jsx)(y.N0Z,{fontSize:"1.8rem"}):(0,i.jsx)(y.bI9,{fontSize:"1.8rem"}),onClick:z,color:e.pinned?"var(--chakra-colors-brand-500)":"currentColor"})})})]})}},37398:function(n,e,t){var r=t(85893),o=(t(67294),t(96356));e.Z=function(n){var e=n.tag;return(0,r.jsxs)(o.Vp,{cursor:"pointer",as:"a",href:"/tags/".concat(e.name),fontSize:"sm",children:["#",e.name]})}}}]);