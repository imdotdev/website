"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2809],{11391:function(e,n,r){r.d(n,{Ph:function(){return x}});var t=r(79762),i=r(11604),l=r(94244),a=r(19703),o=r(38554),c=r.n(o),s=r(67294);function u(){return u=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}return e},u.apply(this,arguments)}function f(e,n){if(null==e)return{};var r,t,i={},l=Object.keys(e);for(t=0;t<l.length;t++)r=l[t],n.indexOf(r)>=0||(i[r]=e[r]);return i}var d=["children","placeholder","className"],h=["rootProps","placeholder","icon","color","height","h","minH","minHeight","iconColor","iconSize","isFullWidth"],p=["children"],v=(0,i.Gp)((function(e,n){var r=e.children,t=e.placeholder,l=e.className,o=f(e,d);return s.createElement(i.m$.select,u({},o,{ref:n,className:(0,a.cx)("chakra-select",l)}),t&&s.createElement("option",{value:""},t),r)}));a.Ts&&(v.displayName="SelectField");var x=(0,i.Gp)((function(e,n){var r=(0,i.jC)("Select",e),o=(0,i.Lr)(e),d=o.rootProps,p=o.placeholder,x=o.icon,b=o.color,m=o.height,y=o.h,g=o.minH,O=o.minHeight,w=o.iconColor,S=o.iconSize;o.isFullWidth;var k=f(o,h),C=(0,a.Vl)(k,l.oE),P=C[0],E=C[1],_=(0,t.Yp)(E),T={width:"100%",height:"fit-content",position:"relative",color:b},I=c()({paddingEnd:"2rem"},r.field,{_focus:{zIndex:"unset"}});return s.createElement(i.m$.div,u({className:"chakra-select__wrapper",__css:T},P,d),s.createElement(v,u({ref:n,height:null!=y?y:m,minH:null!=g?g:O,placeholder:p},_,{__css:I}),e.children),s.createElement(j,u({"data-disabled":(0,a.PB)(_.disabled)},(w||b)&&{color:w||b},{__css:r.icon},S&&{fontSize:S}),x))}));a.Ts&&(x.displayName="Select");var b=function(e){return s.createElement("svg",u({viewBox:"0 0 24 24"},e),s.createElement("path",{fill:"currentColor",d:"M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z"}))},m=(0,i.m$)("div",{baseStyle:{position:"absolute",display:"inline-flex",alignItems:"center",justifyContent:"center",pointerEvents:"none",top:"50%",transform:"translateY(-50%)"}}),j=function(e){var n=e.children,r=void 0===n?s.createElement(b,null):n,t=f(e,p),i=s.cloneElement(r,{role:"presentation",className:"chakra-select__icon",focusable:!1,"aria-hidden":!0,style:{width:"1em",height:"1em",color:"currentColor"}});return s.createElement(m,u({},t,{className:"chakra-select__icon-wrapper"}),s.isValidElement(r)?i:null)};a.Ts&&(j.displayName="SelectIcon")},83504:function(e,n,r){var t=r(85893),i=r(68527),l=r(1950),a=r(62665),o=r(24871),c=r(96486),s=r(67294),u=r(63091),f=r(70577);function d(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function h(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){d(e,n,r[n])}))}return e}function p(e,n){if(null==e)return{};var r,t,i=function(e,n){if(null==e)return{};var r,t,i={},l=Object.keys(e);for(t=0;t<l.length;t++)r=l[t],n.indexOf(r)>=0||(i[r]=e[r]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)r=l[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}n.Z=function(e){var n=e.title,r=e.routes,d=e.children,v=e.p,x=p(e,["title","routes","children","p"]),b=(0,a.Z)().session,m=(0,s.useState)(r),j=m[0],y=m[1];return(0,s.useEffect)((function(){if(null===b||void 0===b?void 0:b.user){var e=!0,n=!1,r=void 0;try{for(var t,i=j[Symbol.iterator]();!(e=(t=i.next()).done);e=!0){var l=t.value;l.minRole==u.u.ContentAdmin?l.disabled=!(0,f.SL)(b.user.role):l.minRole==u.u.ADMIN&&(l.disabled=!(0,f.GJ)(b.user.role))}}catch(a){n=!0,r=a}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}}y((0,c.cloneDeep)(j))}),[null===b||void 0===b?void 0:b.user]),(0,t.jsxs)(i.xu,{display:"flex",children:[(0,t.jsx)(o.Z,h({routes:j,title:n},x)),(0,t.jsx)(l.ZP,{className:"side-card",ml:"4",width:"100%",p:null!==v&&void 0!==v?v:6,pb:"1",children:d})]})}},99901:function(e,n,r){var t=r(85893),i=r(11604),l=r(20949),a=r(41664),o=r(11163);function c(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){c(e,n,r[n])}))}return e}function u(e,n){if(null==e)return{};var r,t,i=function(e,n){if(null==e)return{};var r,t,i={},l=Object.keys(e);for(t=0;t<l.length;t++)r=l[t],n.indexOf(r)>=0||(i[r]=e[r]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)r=l[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var f=r(67294).forwardRef((function(e,n){var r=e.isActive,a=e.icon,o=e.children,c=u(e,["isActive","icon","children"]);return(0,t.jsxs)(i.m$.a,s({"aria-current":r?"page":void 0,width:"100%",px:"3",py:"2",rounded:"md",ref:n,fontSize:"1rem",fontWeight:"bold",color:(0,l.ff)("gray.700","whiteAlpha.900"),transition:"all 0.2s",display:"flex",alignItems:"center",className:"hover-bg",_activeLink:{color:(0,l.ff)("var(--chakra-colors-brand-500)","brand.200"),fontWeight:"600"}},c,{children:[a&&(0,t.jsx)(i.m$.span,{mr:"5",fontSize:"1.1rem",display:{base:"none",md:"block"},width:"20px",children:a}),(0,t.jsx)(i.m$.span,{children:o})]}))}));n.Z=function(e){var n,r=e.href,l=e.icon,c=e.children,d=e.query,h=e.exactPath,p=void 0!==h&&h,v=u(e,["href","icon","children","query","exactPath"]),x=(0,o.useRouter)().asPath;return n=p?x.split("?")[0]==encodeURI(r):x.startsWith(encodeURI(r)),(0,t.jsx)(i.m$.div,s({userSelect:"none",display:"flex",alignItems:"center",lineHeight:"1.5rem"},v,{children:(0,t.jsx)(a.default,{href:{pathname:r,query:d},passHref:!0,children:(0,t.jsx)(f,{isActive:n,icon:l,children:c})})}))}},24871:function(e,n,r){var t=r(85893),i=r(68527),l=r(1950),a=r(11163),o=r(67294),c=r(99901);function s(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){s(e,n,r[n])}))}return e}function f(e,n){if(null==e)return{};var r,t,i=function(e,n){if(null==e)return{};var r,t,i={},l=Object.keys(e);for(t=0;t<l.length;t++)r=l[t],n.indexOf(r)>=0||(i[r]=e[r]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(t=0;t<l.length;t++)r=l[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function d(e){var n=e.routes,r=(e.pathname,e.contentRef,f(e,["routes","pathname","contentRef"]));return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(i.Kq,{as:"ul",children:n.map((function(e){return e.disabled?null:(0,t.jsx)(c.Z,u({as:"li",href:e.path,icon:e.icon},r,{children:(0,t.jsx)("span",{children:e.title})}),e.path)}))})})}n.Z=function(e){var n=e.routes,r=e.title,c=f(e,["routes","title"]),s=(0,a.useRouter)().pathname,h=o.useRef(null);return(0,t.jsxs)(i.gC,{alignItems:"left",width:["180px","180px","250px","250px"],height:"fit-content",children:[(0,t.jsx)(l.ZP,{p:"5",className:"side-card",children:(0,t.jsx)(i.X6,{size:"md",fontSize:"1.3rem",children:r})}),(0,t.jsx)(l.ZP,u({p:"0",className:"side-card"},c,{children:(0,t.jsx)(i.xu,{ref:h,as:"nav","aria-label":"Main Navigation",pos:"sticky",sx:{overscrollBehavior:"contain"},top:"8.5rem",p:"3",overflowY:"auto",className:"sidebar-content",flexShrink:0,children:(0,t.jsx)(d,u({routes:n,pathname:s,contentRef:h},c))})}))]})}},52809:function(e,n,r){r.r(n),r.d(n,{NavbarEditor:function(){return _}});var t=r(34051),i=r.n(t),l=r(85893),a=r(97375),o=r(28609),c=r(68527),s=r(15193),u=r(79042),f=r(88718),d=r(4612),h=r(11391),p=r(36114),v=r(67294),x=r(41039),b=r(84696),m=r(40328),j=r(21948),y=r(86967),g=r(96486),O=r(26822),w=r(30092),S=r(83504);function k(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function C(e,n,r,t,i,l,a){try{var o=e[l](a),c=o.value}catch(s){return void r(s)}o.done?n(c):Promise.resolve(c).then(t,i)}function P(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var l=e.apply(n,r);function a(e){C(l,t,i,a,o,"next",e)}function o(e){C(l,t,i,a,o,"throw",e)}a(void 0)}))}}function E(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,i,l=[],a=!0,o=!1;try{for(r=r.call(e);!(a=(t=r.next()).done)&&(l.push(t.value),!n||l.length!==n);a=!0);}catch(c){o=!0,i=c}finally{try{a||null==r.return||r.return()}finally{if(o)throw i}}return l}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return k(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return k(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.default=function(){return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(w.Z,{title:"\u4e2a\u4eba\u8bbe\u7f6e-\u535a\u5ba2\u83dc\u5355",children:(0,l.jsx)(S.Z,{title:"\u4e2a\u4eba\u8bbe\u7f6e",routes:x._Q,children:(0,l.jsx)(_,{})})})})};var _=function(e){var n=e.orgID,r=void 0===n?"":n,t=(0,v.useState)([]),x=t[0],j=t[1],w=(0,v.useState)([]),S=w[0],k=w[1],C=(0,v.useState)(null),E=C[0],_=C[1],I=(0,a.qY)(),z=I.isOpen,R=I.onOpen,N=I.onClose,L=(0,o.pm)();(0,v.useEffect)((function(){A(),Z()}),[]);var A=function(){var e=P(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.rR.get("/user/navbars?id=".concat(r||0));case 2:n=e.sent,j(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=P(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=7;break}return e.next=4,b.rR.get("/story/posts/org/".concat(r,"?type=").concat(O.iJ.Series));case 4:n=e.sent,e.next=10;break;case 7:return e.next=9,b.rR.get("/story/posts/editor?type=".concat(O.iJ.Series));case 9:n=e.sent;case 10:k(n.data);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(){var e=P(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(E.label&&E.value){e.next=3;break}return L({description:"\u503c\u4e0d\u80fd\u4e3a\u7a7a",status:"error",duration:2e3,isClosable:!0}),e.abrupt("return");case 3:if(!(E.label.length>m.v.user.navbarMaxLen)){e.next=6;break}return L({description:"Label\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7".concat(m.v.user.navbarMaxLen),status:"error",duration:2e3,isClosable:!0}),e.abrupt("return");case 6:if(!r){e.next=11;break}return e.next=9,b.rR.post("/org/navbar/".concat(r),E);case 9:e.next=13;break;case 11:return e.next=13,b.rR.post("/user/navbar",E);case 13:_(null),N(),A();case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(e){_(e),R()},W=function(){var e=(0,g.cloneDeep)(E);_(e)},F=function(e){var n=!0,r=!1,t=void 0;try{for(var i,l=S[Symbol.iterator]();!(n=(i=l.next()).done);n=!0){var a=i.value;if(a.id===e)return a.title}}catch(o){r=!0,t=o}finally{try{n||null==l.return||l.return()}finally{if(r)throw t}}return""},Y=function(){var e=P(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.rR.delete("/".concat(r?"org":"user","/navbar/").concat(n));case 2:A();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(c.kC,{justifyContent:"space-between",alignItems:"center",children:[(0,l.jsx)(c.X6,{size:"sm",children:"\u83dc\u5355\u8bbe\u7f6e"}),(0,l.jsx)(s.zx,{size:"sm",onClick:function(){_({weight:0,type:y.C.Link,label:"",value:"https://"}),R()},_focus:{border:null},children:"\u65b0\u5efa\u83dc\u5355\u9879"})]}),(0,l.jsxs)(u.iA,{variant:"simple",mt:"4",children:[(0,l.jsx)(u.hr,{children:(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Th,{children:"Label"}),(0,l.jsx)(u.Th,{children:"Type"}),(0,l.jsx)(u.Th,{children:"Value"}),(0,l.jsx)(u.Th,{children:"Weight"}),(0,l.jsx)(u.Th,{})]})}),(0,l.jsx)(u.p3,{children:x.map((function(e,n){return(0,l.jsx)(T,{nv:e,onEdit:U,onDelete:Y,getSeriesTitle:F},e.id)}))})]}),(0,l.jsxs)(f.u_,{isOpen:z,onClose:N,children:[(0,l.jsx)(f.ZA,{}),E&&(0,l.jsxs)(f.hz,{children:[(0,l.jsx)(f.xB,{children:E.label?"\u7f16\u8f91\u83dc\u5355\u9879":"\u65b0\u5efa\u83dc\u5355\u9879"}),(0,l.jsxs)(f.fe,{mb:"2",children:[(0,l.jsxs)(c.gC,{spacing:"4",alignItems:"left",children:[(0,l.jsxs)(c.Ug,{spacing:"4",children:[(0,l.jsx)(c.X6,{size:"xs",children:"Label"}),(0,l.jsx)(d.II,{value:E.label,_focus:{border:null},variant:"flushed",onChange:function(e){E.label=e.currentTarget.value,W()}})]}),(0,l.jsxs)(c.Ug,{spacing:"4",children:[(0,l.jsx)(c.X6,{size:"xs",children:"Type"}),(0,l.jsxs)(h.Ph,{value:E.type,onChange:function(e){return function(e){var n=parseInt(e);E.type=n,n===y.C.Link?E.value="":E.value=S[0].id,W()}(e.currentTarget.value)},variant:"flushed",_focus:{border:null},children:[(0,l.jsx)("option",{value:y.C.Link,children:"Link"}),(0,l.jsx)("option",{value:y.C.Series,children:"Series"})]})]}),(0,l.jsxs)(c.Ug,{spacing:"4",children:[(0,l.jsx)(c.X6,{size:"xs",children:"Value"}),E.type===y.C.Link?(0,l.jsx)(d.II,{value:E.value,_focus:{border:null},variant:"flushed",onChange:function(e){E.value=e.currentTarget.value,W()}}):(0,l.jsx)(h.Ph,{value:E.value,variant:"flushed",_focus:{border:null},onChange:function(e){E.value=e.currentTarget.value,W()},children:S.map((function(e){return(0,l.jsx)("option",{value:e.id,children:e.title},e.id)}))})]}),(0,l.jsxs)(c.Ug,{spacing:"4",children:[(0,l.jsx)(c.X6,{size:"xs",children:"Weight"}),(0,l.jsxs)(p.Y2,{min:0,max:10,value:E.weight,variant:"flushed",onChange:function(e){E.weight=parseInt(e),W()},children:[(0,l.jsx)(p.zu,{_focus:{border:null}}),(0,l.jsxs)(p.Fi,{children:[(0,l.jsx)(p.WQ,{}),(0,l.jsx)(p.Y_,{})]})]})]})]}),(0,l.jsx)(s.zx,{variant:"outline",mt:"6",onClick:D,children:"\u63d0\u4ea4"})]})]})]})]})},T=function(e){var n=e.nv,r=e.onEdit,t=e.onDelete,i=e.getSeriesTitle,a=E(v.useState(!1),2),o=a[0],c=a[1],d=function(){return c(!1)},h=v.useRef();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(u.Tr,{children:[(0,l.jsx)(u.Td,{children:n.label}),(0,l.jsx)(u.Td,{children:n.type===y.C.Link?"link":"series"}),(0,l.jsx)(u.Td,{children:n.type===y.C.Link?n.value:i(n.value)}),(0,l.jsx)(u.Td,{children:n.weight}),(0,l.jsxs)(u.Td,{children:[(0,l.jsx)(s.hU,{colorScheme:"gray","aria-label":"edit navbar",variant:"ghost",icon:(0,j.a)("edit",".95rem"),onClick:function(){return r(n)}}),(0,l.jsx)(s.hU,{colorScheme:"gray","aria-label":"delete navbar",variant:"ghost",icon:(0,j.a)("close","1rem"),onClick:function(){return c(!0)}})]})]}),(0,l.jsx)(f.aR,{isOpen:o,leastDestructiveRef:h,onClose:d,children:(0,l.jsx)(f.dh,{children:(0,l.jsxs)(f._T,{children:[(0,l.jsxs)(f.fY,{fontSize:"lg",fontWeight:"bold",children:["\u5220\u9664\u83dc\u5355 -  ",n.label]}),(0,l.jsx)(f.iP,{children:"Are you sure? You can't undo this action afterwards."}),(0,l.jsxs)(f.xo,{children:[(0,l.jsx)(s.zx,{ref:h,onClick:d,children:"Cancel"}),(0,l.jsx)(s.zx,{colorScheme:"red",onClick:function(){return t(n.id)},ml:3,children:"Delete"})]})]})})})]})}},86967:function(e,n,r){var t,i;r.d(n,{C:function(){return t},l:function(){return i}}),function(e){e[e.Link=1]="Link",e[e.Series=2]="Series"}(t||(t={})),function(e){e[e.Preset=1]="Preset",e[e.UserCustom=2]="UserCustom"}(i||(i={}))}}]);