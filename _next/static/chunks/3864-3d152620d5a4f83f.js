"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3864],{63864:function(e,n,r){r.r(n),r.d(n,{Toc:function(){return T},TocNode:function(){return E},default:function(){return R}});var t=r(34051),i=r.n(t),c=r(85893),o=r(68527),s=r(47398),a=r(15193),u=r(20949),l=r(51646),d=r(11604),h=r(67294),f=r(56721),x=r(58937),v=r(84696),p=r(21948),g=r(56184),m=r(17586),j=r(93122),y=r(89583),b=r(8193),w=r(50902);var S=function(e){var n=e.course,r=e.onTocToggle,t=(0,h.useState)(null),i=(t[0],t[1]);return(0,h.useEffect)((function(){n&&v.rR.get("/interaction/followed/".concat(n.id)).then((function(e){return i(e.data)}))}),[]),(0,c.jsx)(d.m$.header,{transition:"box-shadow 0.2s",width:"full",children:(0,c.jsxs)(d.m$.div,{height:"3.5rem",mx:"auto",children:[(0,c.jsxs)(o.kC,{w:"100%",h:"100%",align:"center",justify:"space-between",children:[(0,c.jsxs)(o.Ug,{spacing:"6",children:[(0,c.jsx)(y.AeW,{cursor:"pointer",onClick:r}),(0,c.jsx)(w.Z,{children:(0,c.jsx)(o.xu,{children:(0,c.jsx)(y.SaA,{cursor:"pointer"})})})]}),(0,c.jsx)(o.xv,{fontWeight:"extrabold",fontSize:"1.1rem",as:"a",href:"/course/".concat(n.id),children:n.title}),(0,c.jsxs)(o.Ug,{spacing:"1",children:[(0,c.jsx)(s.u,{label:"\u6559\u7a0b\u5185\u641c\u7d22",openDelay:300,children:(0,c.jsx)("a",{href:"".concat(g.N.Search),children:(0,c.jsx)(a.hU,{size:"md",fontSize:"lg",variant:"ghost",color:"current",_focus:{border:null},icon:(0,p.a)("search"),"aria-label":"search in this blog"})})}),(0,c.jsx)(f.Z,{}),n.github&&(0,c.jsx)(a.hU,{size:"md",fontSize:"lg","aria-label":"github address",variant:"ghost",color:"current",as:"a",href:n.github,_focus:{border:null},icon:(0,c.jsx)(b.RrF,{})}),n.website&&(0,c.jsx)(a.hU,{size:"md",fontSize:"lg","aria-label":"github address",variant:"ghost",color:"current",as:"a",href:n.github,_focus:{border:null},icon:(0,c.jsx)(b.V9Z,{})}),(0,c.jsx)(x.Z,{})]})]}),(0,c.jsx)(m.Z,{}),(0,c.jsx)(j.Z,{})]})})},k=r(11163),C=r(70615),z=r(85832),I=r(87609),q=function(e){var n=e.views,r=e.fontSize,t=void 0===r?"1rem":r;return(0,c.jsx)(s.u,{label:"\u6d4f\u89c8\u91cf",children:(0,c.jsxs)(o.Ug,{children:[(0,c.jsx)(y.dSq,{fontSize:t}),(0,c.jsx)(I.Z,{count:n})]})})},_=r(86459);function Z(e,n,r,t,i,c,o){try{var s=e[c](o),a=s.value}catch(u){return void r(u)}s.done?n(a):Promise.resolve(a).then(t,i)}function N(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var c=e.apply(n,r);function o(e){Z(c,t,i,o,s,"next",e)}function s(e){Z(c,t,i,o,s,"throw",e)}o(void 0)}))}}var R=function(){var e=(0,k.useRouter)(),n=(0,h.useState)(null),r=n[0],t=n[1],u=(0,h.useState)(null),d=u[0],f=u[1],x=(0,h.useState)(null),p=x[0],g=x[1],m=(0,h.useState)(!0),j=m[0],y=m[1],w=(0,h.useState)(null),I=w[0],Z=w[1],R=(0,h.useState)(null),E=R[0],F=R[1];(0,h.useEffect)((function(){var n=e.query.id;n&&(U(n),D(n),n)}),[e.query.id]),(0,h.useEffect)((function(){e.query.page_id&&"0"!=e.query.page_id&&P(e.query.page_id)}),[e.query.page_id]),(0,h.useEffect)((function(){if(e.query.page_id&&"0"!=e.query.page_id&&d){var n=e.query.page_id,r=[],t=!0,i=!1,c=void 0;try{for(var o,s=d[Symbol.iterator]();!(t=(o=s.next()).done);t=!0){var a,u=o.value;if(u.isGroup||r.push(u),(null===(a=u.children)||void 0===a?void 0:a.length)>0){var l=!0,h=!1,f=void 0;try{for(var x,v=u.children[Symbol.iterator]();!(l=(x=v.next()).done);l=!0){var p,g=x.value;if(g.isGroup||r.push(g),(null===(p=g.children)||void 0===p?void 0:p.length)>0){var m=!0,j=!1,y=void 0;try{for(var b,w=g.children[Symbol.iterator]();!(m=(b=w.next()).done);m=!0){var S=b.value;S.isGroup||r.push(S)}}catch(C){j=!0,y=C}finally{try{m||null==w.return||w.return()}finally{if(j)throw y}}}}}catch(C){h=!0,f=C}finally{try{l||null==v.return||v.return()}finally{if(h)throw f}}}}}catch(C){i=!0,c=C}finally{try{t||null==s.return||s.return()}finally{if(i)throw c}}for(var k=0;k<r.length;k++)if(r[k].id==n){Z(k>0?r[k-1].id:null),k<r.length-1?F(r[k+1].id):F(null);break}}}),[e.query.page_id,d]);var G,P=function(){var e=N(i().mark((function e(n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.rR.get("/course/page/".concat(n));case 2:r=e.sent,g(null),g(r.data);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),U=function(){var e=N(i().mark((function e(n){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.rR.get("/course/byId/".concat(n));case 2:r=e.sent,t(r.data);case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),D=function(){var n=N(i().mark((function n(r){var t;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.rR.get("/course/toc/".concat(r));case 2:t=n.sent,f(t.data),"0"==e.query.page_id&&t.data.length>0&&e.push("/course/".concat(r,"/").concat(t.data[0].id));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,c.jsx)(c.Fragment,{children:r&&d&&(0,c.jsxs)(o.xu,{height:"100vh",alignItems:"top",transition:"all .3s cubic-bezier(.4,0,.2,1)",children:[(0,c.jsx)(o.xu,{position:"fixed",px:"3",py:"6",top:"0",height:"100%",left:j?"0px":"-250px",width:"250px",transition:"all 0.3s cubic-bezier(.4,0,.2,1)",className:"side-card",children:(0,c.jsx)(T,{toc:d,courseId:r.id})}),(0,c.jsxs)(o.xu,{transition:"all 0.3s cubic-bezier(.4,0,.2,1)",width:"auto",ml:j?"250px":"0px",px:{base:0,md:6},children:[(0,c.jsx)(S,{course:r,onTocToggle:function(){return y(!j)}}),p&&(0,c.jsxs)(o.kC,{height:"100%",px:{base:1,md:6},children:[(0,c.jsxs)(o.xu,{className:"card-opaque",mr:{base:0,md:"200px"},width:"100%",children:[(0,c.jsx)(l.J,{md:p.md,enableToc:!0,p:"4"}),(0,c.jsxs)(o.kC,{justify:"space-between",py:"8",children:[I?(0,c.jsx)(s.u,{label:"\u4e0a\u4e00\u7ae0\u8282",children:(0,c.jsx)(a.zx,{variant:"outline",className:"side-card",size:"lg",onClick:function(){return e.push("/course/".concat(r.id,"/").concat(I))},children:(0,c.jsx)(b.CF5,{})})}):(0,c.jsx)(o.xu,{}),(0,c.jsxs)(o.Ug,{children:[(0,c.jsx)(z.Z,{storyID:p.id,count:null!==(G=p.likes)&&void 0!==G?G:0,liked:p.liked,fontSize:"1rem"}),(0,c.jsx)(q,{views:p.views})]}),E&&(0,c.jsx)(s.u,{label:"\u4e0b\u4e00\u7ae0\u8282",children:(0,c.jsx)(a.zx,{variant:"outline",className:"side-card",size:"lg",onClick:function(){return e.push("/course/".concat(r.id,"/").concat(E))},children:(0,c.jsx)(b.Td4,{})})})]}),r.comment&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.iz,{}),(0,c.jsx)(o.xu,{mt:"4",children:(0,c.jsx)(C.Z,{storyID:p.id,storyCreator:r.creator.id})})]})]}),(0,c.jsx)(o.xu,{maxW:"200px",display:{base:"none",md:"block"},position:"fixed",left:"calc(100% - 230px)",className:"toc course-toc card-opaque",p:"4",children:(0,c.jsx)(_.Z,{})})]})]})]})})},T=function(e){var n=e.toc,r=e.courseId;return(0,c.jsx)(c.Fragment,{children:(0,c.jsx)(o.gC,{alignItems:"left",spacing:"3",children:n.map((function(e){return(0,c.jsx)(E,{toc:e,courseId:r})}))})})},E=function(e){var n,r,t=e.courseId,i=e.toc,s=(0,k.useRouter)(),a=(0,h.useState)(!0),l=a[0],d=a[1];return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)(o.kC,{justify:"space-between",pt:i.isGroup?2:0,children:[(0,c.jsx)(o.xv,{color:s.query.page_id==i.id?(0,u.ff)("var(--chakra-colors-brand-500)","var(--chakra-colors-brand-200)"):"currentcolor",fontSize:(i.isGroup,"0.95rem"),fontWeight:i.isGroup?"extrabold":"500",cursor:!0===i.isGroup?null:"pointer",onClick:!0===i.isGroup?null:function(){s.push("/course/".concat(t,"/").concat(i.id)),d(!0)},children:i.text}),(null===(n=i.children)||void 0===n?void 0:n.length)>0&&(0,c.jsx)(o.xv,{layerStyle:"textSecondary",cursor:"pointer",fontSize:"0.9rem",transform:l?"rotate(90deg)":null,transition:"transform 0.5s",onClick:function(){return d(!l)},children:"\u2771"})]}),i.isGroup?(0,c.jsx)(o.iz,{}):null,(null===(r=i.children)||void 0===r?void 0:r.length)>0&&l&&(0,c.jsx)(o.xu,{pl:"6",children:(0,c.jsx)(T,{toc:i.children,courseId:t})})]})}},70615:function(e,n,r){var t=r(34051),i=r.n(t),c=r(85893),o=r(67294),s=r(68527),a=r(11391),u=r(15193),l=r(62665),d=r(84696),h=r(38951),f=r(75543),x=r(32532),v=r(96486),p=r(11163);function g(e,n,r,t,i,c,o){try{var s=e[c](o),a=s.value}catch(u){return void r(u)}s.done?n(a):Promise.resolve(a).then(t,i)}function m(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var c=e.apply(n,r);function o(e){g(c,t,i,o,s,"next",e)}function s(e){g(c,t,i,o,s,"throw",e)}o(void 0)}))}}n.Z=function(e){var n=e.storyID,r=e.storyCreator,t=(0,p.useRouter)(),g=(0,o.useState)(null),j=g[0],y=g[1],b=(0,o.useState)(!1),w=b[0],S=b[1],k=(0,o.useState)(x.a.Favorites),C=k[0],z=k[1],I=(0,l.Z)().session,q=(0,o.useState)(null),_=q[0],Z=q[1];(0,o.useEffect)((function(){R()}),[]);var N=function(){var e=m(i().mark((function e(r){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.rR.post("/story/comment",{targetID:n,md:r});case 2:t=e.sent,S(!1),t.data.replies=[],j.unshift(t.data),T();case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),R=function(){var e=m(i().mark((function e(r){var c,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.rR.get("/story/comments?id=".concat(n,"&sorter=").concat(null!==r&&void 0!==r?r:C));case 2:c=e.sent,y(c.data),t&&t.asPath.indexOf("#")>-1&&("comments"!=(o=(0,v.split)(t.asPath,"#")[1])&&Z(o),setTimeout((function(){location.href="#"+(0,v.split)(t.asPath,"#")[1]}),300));case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),T=function(){y([]),y(j)},E=function(e){(0,v.remove)(j,(function(n){return n.id==e})),T()};return(0,c.jsx)(c.Fragment,{children:j&&(0,c.jsxs)(s.gC,{spacing:"2",alignItems:"left",id:"comments",children:[(0,c.jsx)(s.xu,{p:"2",children:(0,c.jsxs)(s.kC,{justifyContent:"space-between",px:"1",children:[(0,c.jsxs)(s.Ug,{spacing:"4",children:[(0,c.jsxs)(s.xv,{children:[" ",j.length," \u6761\u8bc4\u8bba "]}),(0,c.jsxs)(a.Ph,{fontWeight:"500",cursor:"pointer",width:"120px",value:C,onChange:function(e){z(e.currentTarget.value),R(e.currentTarget.value)},variant:"unstyled",children:[(0,c.jsx)("option",{value:x.a.Favorites,children:" \u83b7\u8d5e\u6700\u591a"}),(0,c.jsx)("option",{value:x.a.Recent,children:"\u6700\u65b0"})]})]}),(0,c.jsx)(u.zx,{size:"sm",onClick:function(e){I?S(!0):d.HN.open()},_focus:{border:null},children:"\u53d1\u8868\u8bc4\u8bba"})]})}),w&&I&&(0,c.jsx)(f.Z,{storyID:n,user:I.user,md:"",onSubmit:N,onCancel:function(){return S(!1)}}),j.map((function(e){return(0,c.jsx)(h.ZP,{user:null===I||void 0===I?void 0:I.user,comment:e,onChange:T,onRemove:E,storyCreator:r,highlight:_},e.id)}))]})})}},86459:function(e,n,r){r.d(n,{Z:function(){return a}});var t=r(85893),i=r(67294),c=function(){var e=(0,i.useState)([]),n=e[0],r=e[1];return(0,i.useEffect)((function(){var e=Array.from(document.querySelectorAll("h2, h3, h4, h5")),n=o(e);r(n)}),[]),{nestedHeadings:n}},o=function(e){var n=[];return e.forEach((function(e,r){var t=e.innerText,i=e.id,c="ml-0";switch(e.nodeName){case"H3":c="ml-1";break;case"H4":case"H5":c="ml-2"}n.push({id:i,title:t,items:[],className:c})})),n},s=r(11163),a=function(){var e=(0,i.useState)(),n=e[0],r=e[1],o=c().nestedHeadings;return function(e){var n=(0,i.useRef)({});(0,i.useEffect)((function(){var r=new IntersectionObserver((function(r){n.current=r.reduce((function(e,n){return e[n.target.id]=n,e}),n.current);var i=[];Object.keys(n.current).forEach((function(e){var r=n.current[e];r.isIntersecting&&i.push(r)}));var c=function(e){return t.findIndex((function(n){return n.id===e}))};if(1===i.length)e(i[0].target.id);else if(i.length>1){var o=i.sort((function(e,n){return c(e.target.id)>c(n.target.id)}));e(o[0].target.id)}}),{rootMargin:"0px 0px -40% 0px"}),t=Array.from(document.querySelectorAll("h2, h3,h4,h5,h6"));return t.forEach((function(e){return r.observe(e)})),function(){return r.disconnect()}}),[e])}(r),(0,t.jsx)("nav",{"aria-label":"Table of contents",children:(0,t.jsx)(u,{headings:o,activeId:n})})},u=function(e){var n=e.headings,r=e.activeId,i=(0,s.useRouter)();return(0,t.jsx)("ul",{children:n.map((function(e){var n=e.className+(e.id===r?" active":"");return(0,t.jsx)("li",{className:n,children:(0,t.jsx)("a",{href:"#".concat(e.id),onClick:function(n){try{n.preventDefault(),document.querySelector("#".concat(e.id)).scrollIntoView({behavior:"smooth"})}catch(r){i.push("#".concat(e.id))}},children:e.title})},e.id)}))})}}}]);