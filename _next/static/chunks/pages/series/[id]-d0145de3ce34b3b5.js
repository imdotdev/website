(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3191],{92684:function(e,n,t){"use strict";t.d(n,{ac:function(){return a}});t(11604);var r=t(19703),i=t(67294),s=t(85393),c=r.jU?i.useLayoutEffect:i.useEffect;function a(e){var n=(0,s.O)(),t=Array.isArray(e)?e:[e],a=r.jU&&"matchMedia"in n.window,o=i.useState(t.map((function(e){return!!a&&!!n.window.matchMedia(e).matches}))),u=o[0],d=o[1];return c((function(){if(a){var e=t.map((function(e){return n.window.matchMedia(e)})),r=e.map((function(n,t){var r=function(n){var t=e.findIndex((function(e){return e.media===n.media}));d((function(e){var r=e.map((function(e){return e}));return r[t]=n.matches,r}))};return"function"===typeof e[t].addEventListener?e[t].addEventListener("change",r):e[t].addListener(r),r}));return function(){e.forEach((function(n,t){"function"===typeof e[t].removeEventListener?e[t].removeEventListener("change",r[t]):e[t].removeListener(r[t])}))}}}),[]),u}r.Ts;r.Ts},3984:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/series/[id]",function(){return t(46618)}])},46618:function(e,n,t){"use strict";t.r(n);var r=t(34051),i=t.n(r),s=t(85893),c=t(68527),a=t(34651),o=t(47398),u=t(11391),d=t(70615),l=t(37398),f=t(83331),x=t(67757),h=t(66703),m=t(11163),p=t(67294),v=t(84696),j=t(85482),y=t(1950),g=t(2993),w=t(70577),b=t(62665),E=t(96653),Z=t(74326),_=t(30092),k=t(1429),S=t(96486),C=t(21201);function I(e,n,t,r,i,s,c){try{var a=e[s](c),o=a.value}catch(u){return void t(u)}a.done?n(o):Promise.resolve(o).then(r,i)}function P(e){return function(){var n=this,t=arguments;return new Promise((function(r,i){var s=e.apply(n,t);function c(e){I(s,r,i,c,a,"next",e)}function a(e){I(s,r,i,c,a,"throw",e)}c(void 0)}))}}n.default=function(){var e=(0,b.Z)().session,n=(0,m.useRouter)(),t=n.query.id,r=(0,p.useState)(null),I=r[0],L=r[1],N=(0,p.useState)([]),z=N[0],T=N[1],U=(0,p.useState)([]),D=U[0],O=U[1],R=(0,p.useState)(1),q=R[0],F=R[1];(0,p.useEffect)((function(){t&&(M(),X(),A())}),[t]),(0,p.useEffect)((function(){n&&n.asPath.indexOf("#comments")>-1&&setTimeout((function(){location.href="#comments"}),100)}),[n]),(0,p.useEffect)((function(){T(1==q?(0,S.sortBy)(z,(function(e){return e.priority})):(0,S.sortBy)(z,(function(e){return-e.priority})))}),[q]);var M=function(){var e=P(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.rR.get("/story/post?id=".concat(t));case 2:n=e.sent,L(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(){var e=P(i().mark((function e(){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.rR.get("/story/series/posts?id=".concat(t));case 2:r=e.sent,T(r.data),n.query.newPost&&F(2);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),A=function(){var e=P(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.rR.get("/disable?target_id=".concat(t));case 2:n=e.sent,O(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z,{title:x.Z.seo.title,description:x.Z.seo.description}),I&&(0,s.jsx)(_.Z,{nav:(0,s.jsx)(h.Z,{post:I}),mt:"2rem",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(c.Ug,{alignItems:"top",spacing:[0,0,14,14],mt:"8",children:[(0,s.jsxs)(c.xu,{width:["100%","100%","75%","75%"],p:[0,0,3,6],className:"side-card",children:[(0,s.jsxs)(c.Ug,{alignItems:"top",children:[(0,s.jsxs)(c.xu,{px:"2",width:"100%",children:[(0,s.jsx)(a.Ee,{src:I.cover,display:{base:"block",md:"none"},mb:"4"}),(0,s.jsx)(c.Ug,{children:(0,s.jsx)(c.X6,{size:"md",my:"3",lineHeight:"1.5",children:I.title})}),(0,s.jsx)(c.iz,{mb:"2"}),(0,s.jsx)(C.Z,{story:I,size:"md"}),(0,s.jsx)(c.iz,{mt:"2"}),(0,s.jsx)(c.xv,{mt:"4",children:I.brief}),(0,s.jsxs)(c.kC,{justify:"space-between",alignItems:"center",mt:"6",children:[(0,s.jsxs)(c.Ug,{spacing:"3",children:[I.rawTags.map((function(e){return(0,s.jsx)(l.Z,{tag:e},e.id)})),!function(){var e=!0,n=!1,t=void 0;try{for(var r,i=D[Symbol.iterator]();!(e=(r=i.next()).done);e=!0){var s=r.value;if(""==s.by)return s}}catch(c){n=!0,t=c}finally{try{e||null==i.return||i.return()}finally{if(n)throw t}}return null}()&&(0,w.SL)(null===e||void 0===e?void 0:e.user.role)&&(0,s.jsx)(c.xu,{mt:"4",children:(0,s.jsx)(E.Z,{targetId:I.id,by:"",onDisable:function(){return A()}})})]}),(0,s.jsx)(o.u,{label:"\u5173\u6ce8\u540e\u53ef\u4ee5\u53ca\u65f6\u6536\u5230\u65b0\u6587\u7ae0\u7684\u63a8\u9001",children:(0,s.jsx)(c.xu,{children:(0,s.jsx)(k.Z,{size:"sm",targetID:I.id,followed:I.followed})})})]}),D.length>0&&(0,s.jsxs)(c.Ug,{mt:"4",children:[" ",D.map((function(e){return(0,s.jsx)(Z.Z,{disabled:e})}))]})]}),I.cover&&(0,s.jsx)(a.Ee,{src:I.cover,width:"300px",display:{base:"none",md:"block"}})]}),(0,s.jsxs)(c.gC,{mt:"4",children:[(0,s.jsx)(c.iz,{mt:"8",mb:"5"}),(0,s.jsx)(c.xv,{position:"relative",top:"-41px",layerStyle:"textSecondary",children:"\u7cfb\u5217\u6587\u7ae0\u5217\u8868"})]}),(0,s.jsxs)(c.kC,{justify:"space-between",children:[(0,s.jsx)(c.xu,{}),(0,s.jsxs)(u.Ph,{value:q,onChange:function(e){return F(Number(e.currentTarget.value))},width:"150px",variant:"unstyled",children:[(0,s.jsx)("option",{value:1,children:"\u6dfb\u52a0\u65f6\u95f4\u6b63\u5e8f"}),(0,s.jsx)("option",{value:2,children:"\u6dfb\u52a0\u65f6\u95f4\u5012\u5e8f"})]})]}),z.length>0&&(0,s.jsx)(y.ZP,{p:"0",children:(0,s.jsx)(c.gC,{alignItems:"left",spacing:"0",children:z.map((function(e,t){return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Z,{story:e,highlighted:n.query.newPost==e.id}),t<z.length-1&&(0,s.jsx)(c.iz,{})]})}))})}),(0,s.jsx)(c.xu,{mt:"6",children:(0,s.jsx)(d.Z,{storyID:I.id,storyCreator:I.creatorId})})]}),(0,s.jsx)(c.xu,{pt:"16",className:"side-card",children:(0,s.jsx)(j.Z,{story:I,onStoryChange:function(){return L((0,S.cloneDeep)(I))}})})]})})})]})}}},function(e){e.O(0,[5445,4885,4617,1921,1228,8703,7351,8718,2539,1111,3649,9177,7763,1382,4349,3009,6771,1926,9840,2993,5769,2542,8951,9186,9774,2888,179],(function(){return n=3984,e(e.s=n);var n}));var n=e.O();_N_E=n}]);