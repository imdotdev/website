(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9401],{61041:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/navbar",function(){return r(78938)}])},83504:function(e,n,r){"use strict";var t=r(85893),i=r(68527),a=r(1950),o=r(62665),l=r(24871),c=r(96486),s=r(67294),u=r(63091),f=r(70577);function d(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function h(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){d(e,n,r[n])}))}return e}function p(e,n){if(null==e)return{};var r,t,i=function(e,n){if(null==e)return{};var r,t,i={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(i[r]=e[r]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}n.Z=function(e){var n=e.title,r=e.routes,d=e.children,x=e.p,v=p(e,["title","routes","children","p"]),b=(0,o.Z)().session,j=(0,s.useState)(r),m=j[0],y=j[1];return(0,s.useEffect)((function(){if(null===b||void 0===b?void 0:b.user){var e=!0,n=!1,r=void 0;try{for(var t,i=m[Symbol.iterator]();!(e=(t=i.next()).done);e=!0){var a=t.value;a.minRole==u.u.ContentAdmin?a.disabled=!(0,f.SL)(b.user.role):a.minRole==u.u.ADMIN&&(a.disabled=!(0,f.GJ)(b.user.role))}}catch(o){n=!0,r=o}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}}y((0,c.cloneDeep)(m))}),[null===b||void 0===b?void 0:b.user]),(0,t.jsxs)(i.xu,{display:"flex",children:[(0,t.jsx)(l.Z,h({routes:m,title:n},v)),(0,t.jsx)(a.ZP,{className:"side-card",ml:"4",width:"100%",p:null!==x&&void 0!==x?x:6,pb:"1",children:d})]})}},99901:function(e,n,r){"use strict";var t=r(85893),i=r(11604),a=r(20949),o=r(41664),l=r(11163);function c(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function s(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){c(e,n,r[n])}))}return e}function u(e,n){if(null==e)return{};var r,t,i=function(e,n){if(null==e)return{};var r,t,i={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(i[r]=e[r]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var f=r(67294).forwardRef((function(e,n){var r=e.isActive,o=e.icon,l=e.children,c=u(e,["isActive","icon","children"]);return(0,t.jsxs)(i.m$.a,s({"aria-current":r?"page":void 0,width:"100%",px:"3",py:"2",rounded:"md",ref:n,fontSize:"1rem",fontWeight:"bold",color:(0,a.ff)("gray.700","whiteAlpha.900"),transition:"all 0.2s",display:"flex",alignItems:"center",className:"hover-bg",_activeLink:{color:(0,a.ff)("var(--chakra-colors-brand-500)","brand.200"),fontWeight:"600"}},c,{children:[o&&(0,t.jsx)(i.m$.span,{mr:"5",fontSize:"1.1rem",display:{base:"none",md:"block"},width:"20px",children:o}),(0,t.jsx)(i.m$.span,{children:l})]}))}));n.Z=function(e){var n,r=e.href,a=e.icon,c=e.children,d=e.query,h=e.exactPath,p=void 0!==h&&h,x=u(e,["href","icon","children","query","exactPath"]),v=(0,l.useRouter)().asPath;return n=p?v.split("?")[0]==encodeURI(r):v.startsWith(encodeURI(r)),(0,t.jsx)(i.m$.div,s({userSelect:"none",display:"flex",alignItems:"center",lineHeight:"1.5rem"},x,{children:(0,t.jsx)(o.default,{href:{pathname:r,query:d},passHref:!0,children:(0,t.jsx)(f,{isActive:n,icon:a,children:c})})}))}},24871:function(e,n,r){"use strict";var t=r(85893),i=r(68527),a=r(1950),o=r(11163),l=r(67294),c=r(99901);function s(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function u(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},t=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),t.forEach((function(n){s(e,n,r[n])}))}return e}function f(e,n){if(null==e)return{};var r,t,i=function(e,n){if(null==e)return{};var r,t,i={},a=Object.keys(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||(i[r]=e[r]);return i}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(t=0;t<a.length;t++)r=a[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function d(e){var n=e.routes,r=(e.pathname,e.contentRef,f(e,["routes","pathname","contentRef"]));return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(i.Kq,{as:"ul",children:n.map((function(e){return e.disabled?null:(0,t.jsx)(c.Z,u({as:"li",href:e.path,icon:e.icon},r,{children:(0,t.jsx)("span",{children:e.title})}),e.path)}))})})}n.Z=function(e){var n=e.routes,r=e.title,c=f(e,["routes","title"]),s=(0,o.useRouter)().pathname,h=l.useRef(null);return(0,t.jsxs)(i.gC,{alignItems:"left",width:["180px","180px","250px","250px"],height:"fit-content",children:[(0,t.jsx)(a.ZP,{p:"5",className:"side-card",children:(0,t.jsx)(i.X6,{size:"md",fontSize:"1.3rem",children:r})}),(0,t.jsx)(a.ZP,u({p:"0",className:"side-card"},c,{children:(0,t.jsx)(i.xu,{ref:h,as:"nav","aria-label":"Main Navigation",pos:"sticky",sx:{overscrollBehavior:"contain"},top:"8.5rem",p:"3",overflowY:"auto",className:"sidebar-content",flexShrink:0,children:(0,t.jsx)(d,u({routes:n,pathname:s,contentRef:h},c))})}))]})}},78938:function(e,n,r){"use strict";r.r(n);var t=r(34051),i=r.n(t),a=r(85893),o=r(97375),l=r(28609),c=r(68527),s=r(15193),u=r(79042),f=r(88718),d=r(4612),h=r(36114),p=r(67294),x=r(41039),v=r(84696),b=r(40328),j=r(21948),m=r(86967),y=r(96486),g=r(26822),O=r(30092),w=r(83504);function S(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function k(e,n,r,t,i,a,o){try{var l=e[a](o),c=l.value}catch(s){return void r(s)}l.done?n(c):Promise.resolve(c).then(t,i)}function P(e){return function(){var n=this,r=arguments;return new Promise((function(t,i){var a=e.apply(n,r);function o(e){k(a,t,i,o,l,"next",e)}function l(e){k(a,t,i,o,l,"throw",e)}o(void 0)}))}}function C(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,i,a=[],o=!0,l=!1;try{for(r=r.call(e);!(o=(t=r.next()).done)&&(a.push(t.value),!n||a.length!==n);o=!0);}catch(c){l=!0,i=c}finally{try{o||null==r.return||r.return()}finally{if(l)throw i}}return a}}(e,n)||function(e,n){if(!e)return;if("string"===typeof e)return S(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.default=function(){var e=(0,p.useState)([]),n=e[0],r=e[1],t=(0,p.useState)([]),j=(t[0],t[1]),S=(0,p.useState)(null),k=S[0],C=S[1],I=(0,o.qY)(),R=I.isOpen,T=I.onOpen,z=I.onClose,E=(0,l.pm)();(0,p.useEffect)((function(){A(),N()}),[]);var A=function(){var e=P(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.rR.get("/navbars?c=0");case 2:n=e.sent,r(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),N=function(){var e=P(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.rR.get("/story/posts/editor?type=".concat(g.iJ.Series));case 2:n=e.sent,j(n.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Z=function(){var e=P(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(k.label&&k.value){e.next=3;break}return E({description:"\u503c\u4e0d\u80fd\u4e3a\u7a7a",status:"error",duration:2e3,isClosable:!0}),e.abrupt("return");case 3:if(!(k.label.length>b.v.user.navbarMaxLen)){e.next=6;break}return E({description:"Label\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7".concat(b.v.user.navbarMaxLen),status:"error",duration:2e3,isClosable:!0}),e.abrupt("return");case 6:return e.next=8,v.rR.post("/navbar",k);case 8:C(null),z(),A();case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=function(e){C(e),T()},L=function(){var e=(0,y.cloneDeep)(k);C(e)},U=function(){var e=P(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v.rR.delete("/navbar/".concat(n)),setTimeout((function(){return A()}),300);case 2:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(O.Z,{children:(0,a.jsxs)(w.Z,{title:"\u7ba1\u7406\u5458",routes:x.xt,children:[(0,a.jsxs)(c.kC,{justifyContent:"space-between",alignItems:"center",children:[(0,a.jsx)(c.X6,{size:"md",children:"\u83dc\u5355\u8bbe\u7f6e"}),(0,a.jsx)(s.zx,{size:"sm",onClick:function(){C({weight:0,type:m.C.Link,label:"",value:""}),T()},_focus:{border:null},children:"\u65b0\u5efa\u83dc\u5355\u9879"})]}),(0,a.jsxs)(u.iA,{variant:"simple",mt:"4",children:[(0,a.jsx)(u.hr,{children:(0,a.jsxs)(u.Tr,{children:[(0,a.jsx)(u.Th,{children:"Label"}),(0,a.jsx)(u.Th,{children:"Value"}),(0,a.jsx)(u.Th,{children:"Weight"}),(0,a.jsx)(u.Th,{})]})}),(0,a.jsx)(u.p3,{children:n.map((function(e,n){return(0,a.jsx)(_,{nv:e,onEdit:D,onDelete:U},e.id)}))})]})]})}),(0,a.jsxs)(f.u_,{isOpen:R,onClose:z,children:[(0,a.jsx)(f.ZA,{}),k&&(0,a.jsxs)(f.hz,{children:[(0,a.jsx)(f.xB,{children:k.label?"\u7f16\u8f91\u83dc\u5355\u9879":"\u65b0\u5efa\u83dc\u5355\u9879"}),(0,a.jsxs)(f.fe,{mb:"2",children:[(0,a.jsxs)(c.gC,{spacing:"4",alignItems:"left",children:[(0,a.jsxs)(c.Ug,{spacing:"4",children:[(0,a.jsx)(c.X6,{size:"xs",children:"Label"}),(0,a.jsx)(d.II,{value:k.label,_focus:{border:null},variant:"flushed",onChange:function(e){k.label=e.currentTarget.value,L()}})]}),(0,a.jsxs)(c.Ug,{spacing:"4",children:[(0,a.jsx)(c.X6,{size:"xs",children:"Value"}),(0,a.jsx)(d.II,{value:k.value,_focus:{border:null},variant:"flushed",onChange:function(e){k.value=e.currentTarget.value,L()},placeholder:"enter a url, e.g /search"})]}),(0,a.jsxs)(c.Ug,{spacing:"4",children:[(0,a.jsx)(c.X6,{size:"xs",children:"Weight"}),(0,a.jsxs)(h.Y2,{min:0,max:10,value:k.weight,variant:"flushed",onChange:function(e){k.weight=parseInt(e),L()},children:[(0,a.jsx)(h.zu,{_focus:{border:null}}),(0,a.jsxs)(h.Fi,{children:[(0,a.jsx)(h.WQ,{}),(0,a.jsx)(h.Y_,{})]})]})]})]}),(0,a.jsx)(s.zx,{variant:"outline",mt:"6",onClick:Z,children:"\u63d0\u4ea4"})]})]})]})]})};var _=function(e){var n=e.nv,r=e.onEdit,t=e.onDelete,i=C(p.useState(!1),2),o=i[0],l=i[1],c=function(){return l(!1)},d=p.useRef();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(u.Tr,{children:[(0,a.jsx)(u.Td,{children:n.label}),(0,a.jsx)(u.Td,{children:n.value}),(0,a.jsx)(u.Td,{children:n.weight}),(0,a.jsxs)(u.Td,{children:[(0,a.jsx)(s.hU,{colorScheme:"gray","aria-label":"edit navbar",variant:"ghost",icon:(0,j.a)("edit",".95rem"),onClick:function(){return r(n)}}),(0,a.jsx)(s.hU,{colorScheme:"gray","aria-label":"delete navbar",variant:"ghost",icon:(0,j.a)("close","1rem"),onClick:function(){return l(!0)}})]})]}),(0,a.jsx)(f.aR,{isOpen:o,leastDestructiveRef:d,onClose:c,children:(0,a.jsx)(f.dh,{children:(0,a.jsxs)(f._T,{children:[(0,a.jsxs)(f.fY,{fontSize:"lg",fontWeight:"bold",children:["\u5220\u9664\u83dc\u5355 -  ",n.label]}),(0,a.jsx)(f.iP,{children:"Are you sure? You can't undo this action afterwards."}),(0,a.jsxs)(f.xo,{children:[(0,a.jsx)(s.zx,{ref:d,onClick:c,children:"Cancel"}),(0,a.jsx)(s.zx,{colorScheme:"red",onClick:function(){return t(n.id)},ml:3,children:"Delete"})]})]})})})]})}},86967:function(e,n,r){"use strict";var t,i;r.d(n,{C:function(){return t},l:function(){return i}}),function(e){e[e.Link=1]="Link",e[e.Series=2]="Series"}(t||(t={})),function(e){e[e.Preset=1]="Preset",e[e.UserCustom=2]="UserCustom"}(i||(i={}))}},function(e){e.O(0,[5445,4885,4617,1921,1228,8703,7351,8718,2539,1111,3649,9177,6103,3009,6771,1926,9840,9774,2888,179],(function(){return n=61041,e(e.s=n);var n}));var n=e.O();_N_E=n}]);